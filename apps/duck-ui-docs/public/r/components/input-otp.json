{
  "dependencies": [
    "@gentleduck/libs"
  ],
  "files": [
    {
      "content": "export * from './input-otp'\nexport * from './input-otp.hooks'\n",
      "path": "input-otp/index.ts",
      "target": "components/ui/index.ts",
      "type": "registry:ui"
    },
    {
      "content": "import React from 'react'\nimport { OTPInputContext } from './input-otp'\n\nexport function useOTPInputContext() {\n  const context = React.useContext(OTPInputContext)\n  if (context === null) {\n    throw new Error('useOTPInputContext must be used within a OTPInputProvider')\n  }\n  return context\n}\n\nexport function useInputOTPInit(\n  value?: string,\n  onValueChange?: (value: string) => void,\n  pattern: RegExp = /^[\\w\\d\\p{P}\\p{S}]$/u,\n) {\n  const inputsRef = React.useRef<HTMLInputElement[]>([])\n  const wrapperRef = React.useRef<HTMLDivElement>(null)\n\n  React.useEffect(() => {\n    const html = document.documentElement\n    const wrapper = wrapperRef.current\n    if (!wrapper) return\n\n    const inputs = Array.from(wrapper.querySelectorAll('input[duck-input-otp-slot]')) as HTMLInputElement[]\n    const valueChunks = value?.split('') ?? []\n    inputsRef.current = inputs\n\n    const cleanup: Array<() => void> = []\n\n    const emit = () => onValueChange?.(inputs.map((input) => input.value).join(''))\n\n    const fillFrom = (startIndex: number, text: string) => {\n      const chars = Array.from(text).filter((c) => pattern.test(c))\n      if (chars.length === 0) return\n\n      let j = 0\n      for (let k = startIndex; k < inputs.length && j < chars.length; k++) {\n        inputs[k]!.value = chars[j]!\n        j++\n      }\n\n      const nextFocus = Math.min(startIndex + j, inputs.length - 1)\n      inputs[nextFocus]?.focus()\n      emit()\n    }\n\n    for (let i = 0; i < inputs.length; i++) {\n      const item = inputs[i]!\n      item.value = valueChunks[i] ?? ''\n      item.setAttribute('aria-label', `Digit ${i + 1}`)\n\n      const onKeyDown = (e: KeyboardEvent) => {\n        // navigation keys\n        if (\n          e.key === 'Backspace' ||\n          (e.key === 'ArrowLeft' && html.getAttribute('dir') === 'ltr') ||\n          (e.key === 'ArrowRight' && html.getAttribute('dir') === 'rtl')\n        ) {\n          setTimeout(() => inputs[i - 1]?.focus(), 0)\n        }\n\n        if (\n          (e.key === 'ArrowLeft' && html.getAttribute('dir') === 'rtl') ||\n          (e.key === 'ArrowRight' && (html.getAttribute('dir') === 'ltr' || html.getAttribute('dir') === null))\n        ) {\n          setTimeout(() => inputs[i + 1]?.focus(), 0)\n        }\n\n        // skip special keys\n        if (\n          e.metaKey ||\n          e.ctrlKey ||\n          e.altKey ||\n          ['ArrowLeft', 'ArrowRight', 'Backspace', 'Enter', 'Tab', 'ArrowUp', 'ArrowDown'].includes(e.key)\n        ) {\n          return\n        }\n\n        // validate input with pattern\n        if (!pattern.test(e.key)) {\n          e.preventDefault()\n          return\n        }\n\n        item.value = e.key\n        setTimeout(() => inputs[i + 1]?.focus(), 0)\n        emit()\n      }\n\n      const onPaste = (e: ClipboardEvent) => {\n        const text = e.clipboardData?.getData('text') ?? ''\n        if (!text) return\n        e.preventDefault()\n        fillFrom(i, text) // fills until end then stops\n      }\n\n      item.addEventListener('keydown', onKeyDown)\n      item.addEventListener('paste', onPaste)\n\n      cleanup.push(() => {\n        item.removeEventListener('keydown', onKeyDown)\n        item.removeEventListener('paste', onPaste)\n      })\n    }\n\n    return () => {\n      for (const fn of cleanup) fn()\n    }\n  }, [value, onValueChange, pattern])\n\n  return { inputsRef, wrapperRef }\n}\n",
      "path": "input-otp/input-otp.hooks.ts",
      "target": "components/ui/input-otp.hooks.ts",
      "type": "registry:ui"
    },
    {
      "content": "'use client'\n\nimport { cn } from '@gentleduck/libs/cn'\nimport { Dot } from 'lucide-react'\nimport * as React from 'react'\nimport { useInputOTPInit } from './input-otp.hooks'\n\nexport const REGEXP_ONLY_DIGITS_AND_CHARS = /^[\\w\\d\\p{P}\\p{S}]$/u\nexport const REGEXP_ONLY_DIGITS = /^[0-9]$/\nexport const OTPInputContext = React.createContext<{\n  value?: string\n  wrapperRef: React.RefObject<HTMLDivElement | null>\n  inputsRef: React.RefObject<HTMLInputElement[]>\n} | null>(null)\n\nfunction InputOTP({\n  className,\n  children,\n  value,\n  onValueChange,\n  pattern,\n  ref,\n  'aria-label': ariaLabel = 'otp-one-time-password',\n  ...props\n}: Omit<React.HTMLProps<HTMLDivElement>, 'pattern'> & {\n  value?: string\n  onValueChange?: (value: string) => void\n  pattern?: RegExp\n}) {\n  const { inputsRef, wrapperRef } = useInputOTPInit(value, onValueChange, pattern)\n\n  return (\n    <OTPInputContext.Provider\n      value={{\n        inputsRef,\n        value,\n        wrapperRef,\n      }}>\n      <div\n        aria-label={ariaLabel}\n        className={cn('flex items-center gap-2 disabled:cursor-not-allowed has-[:disabled]:opacity-50', className)}\n        ref={wrapperRef}\n        role=\"region\"\n        {...props}\n        data-slot=\"input-otp\"\n        duck-input-slot=\"\">\n        {children}\n      </div>\n    </OTPInputContext.Provider>\n  )\n}\n\nconst InputOTPGroup = ({ className, ref, ...props }: React.ComponentPropsWithRef<'div'>) => {\n  return (\n    <div\n      aria-label=\"otp-group\"\n      className={cn('flex items-center', className)}\n      ref={ref}\n      role=\"group\"\n      {...props}\n      data-slot=\"input-otp-group\"\n      duck-input-slot=\"\"\n    />\n  )\n}\n\nconst InputOTPSlot = ({ className, ref, ...props }: React.ComponentPropsWithRef<'input'>) => {\n  return (\n    <input\n      aria-invalid=\"false\"\n      aria-required=\"true\"\n      className={cn(\n        'relative -ml-px h-10 w-10 rounded-none border border-input border-input border-y border-r text-center text-center text-sm transition-all first:ml-0 first:rounded-l-md last:rounded-r-md focus:relative focus:z-10 focus:outline-none focus:ring-2 focus:ring-ring',\n        className,\n      )}\n      data-slot=\"input-otp-slot\"\n      duck-input-otp-slot=\"\"\n      maxLength={1}\n      ref={ref}\n      {...props}\n    />\n  )\n}\n\nconst InputOTPSeparator = ({\n  ref,\n  customIndicator,\n  ...props\n}: React.ComponentPropsWithRef<'div'> & {\n  customIndicator?: React.ReactNode\n}) => {\n  return (\n    <div aria-hidden=\"true\" ref={ref} role=\"presentation\" {...props} data-slot=\"input-otp-separator\" duck-input-slot=\"\">\n      {customIndicator ? customIndicator : <Dot />}\n    </div>\n  )\n}\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n",
      "path": "input-otp/input-otp.tsx",
      "target": "components/ui/input-otp.tsx",
      "type": "registry:ui"
    }
  ],
  "name": "input-otp",
  "root_folder": "input-otp",
  "source": "/registry-ui-duckui/src/input-otp",
  "type": "registry:ui"
}
